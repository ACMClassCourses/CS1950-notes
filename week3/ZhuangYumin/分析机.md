摘要：分析机的编程语言是第一个真正意义上的编程语言，通过三类指令（运算类、数据搬移类、控制类），来实现一种图灵完备的运算体系。  
巴贝奇分析机（Babbage Analytical Engine）是一台早期的可编程机械计算机，由英国数学家查尔斯·巴贝奇（Charles Babbage）设计并于1837年提出。尽管该机器从未被完整地构建出来，但它本身的设计逻辑却十分先进，是大约100年后电子通用计算机的先驱。  
分析机使用的编程语言与今天的汇编语言类似，支持循环语句和条件分支，因此这门语言被认为是图灵完备的。
## 课前准备
### 课件中的问题
1. 如何实现C++中的for和while？  
使用一个变量作为计数器，通过runup搭配条件跳转来实现
2. 分析机与差分机的区别和优缺点？  
分析机注重通用性、可编程性，而差分机则专门针对求多项式的值进行了优化。差分机的优点是它是被设计专门用于执行多项式计算，对于这类计算任务具有高效性能，但这也带来了它的缺点：不具有通用性。而分析机的优点在于它的通用性、可编程性；缺点则是指令集较为简单，难以针对常见任务进行优化。
3. 计算斐波那契数列前10项
```txt
N 0 1
N 1 1
N 2 9
N 3 1
N 6 0
#v0是f(n-2)
#v1是f(n-1)
#v2是循环计数器
#v3是常数1，搭配循环计数器
#v5用于临时存储计算结果
#v6是常数0，用于把存储器中的东西挪位置

P 0
#打印一个已经算好的
-
L 2
L 3
?F 14
S 2
#处理循环
+
L 0
L 1
S 5
+
L 6
L 1
S 0
+
L 6
L 5
S 1
#迭代存储器
B 19
#循环结束
+
L 2
L 3
S 2
#一个没啥用的结尾，只是用于跳转
```
### 准备的问题
1. 还有哪些早期语言(有实际运用)是图灵完备的？
2. 还有哪些语言(现代人出于非实用目的发明的)看起来很原始但是是图灵完备的？
3. ppt里的分析机语言只是一个能保证图灵完备的最小指令集，其它分析机解释器(如[Link](https://www.fourmilab.ch/babbage/aem/))支持的一些非必要功能如何用这些基本功能实现？
4. 既然图灵机停机问题没有通用解，那么那些限制执行步数的分析机解释器怎么尽可能在不实际运行的情况下判断一个程序会不会陷入死循环？
5. 分析机有没有并行优化？怎么实现？
### 一些思考
1. 分析机的指令集非常精简，但它是图灵完备的，这种用简单的元件构造复杂系统的思想对计算机科学的发展有重大意义。
2. 分析机虽然没有被实际造出来，但它启发了大量的研究，那些在当前看不到明显实际运用的东西也有研究价值。

### 小作业
#### T1
##### Program 1
###### 功能
仿照差分机的原理打印1~100的平方

分析：  
以下几步是一个重复100次的while循环:
```
-
L 3
L 4
?F 10
S 3
......
B 14
```
以下几步是在做类似于差分机的事情:
```
+
L 0
L 1
S 0
L 1
L 2
S 1
P 0
```
观察初始值：
```
N 0 0
N 1 1
N 2 2
```
可得它输出的是1~100的平方

###### 时间估算
2618秒

计算过程：
初始化：5秒  
一次循环：12+14=26秒  
最后跳出循环：3+10=13秒  
总和：5+(13+14)\*100+13=2618

##### Program 2
###### 功能
用最朴素的方法，打印1~100的平方
分析：
2号变量是循环计数器，1号变量是常数1，while循环部分与program1大同小异  
每次循环把0号变量加上1号变量（常数1），然后把0号变量的平方存入4号变量并打印4号变量  
因此，总体效果是打印$1^2,2^2,3^2,\cdots,100^2$
###### 时间估算
8717秒

计算过程：  
初始化：3秒
一次循环：for本身4+15=19，加法并保存4，乘法并保存63，打印1，总87
最后跳出循环：3+11=14
综合：3+87\*100+14=8717
#### T2
类似于课件中的那题
```
N 0 1
N 1 1
N 2 29
N 3 1
N 6 0
#v0是f(n-2)
#v1是f(n-1)
#v2是循环计数器，控制循环30次
#v3是常数1，搭配循环计数器
#v5用于临时存储计算结果
#v6是常数0，用于把存储器中的东西挪位置

P 0
#打印一个已经算好的
-
L 2
L 3
?F 14
S 2
#处理循环
+
L 0
L 1
S 5
+
L 6
L 1
S 0
+
L 6
L 5
S 1
#迭代存储器
B 19
#循环结束
#程序结束
```
#### T3
仿照差分机的思路来写
```
N 0 15
N 1 42
N 2 80
N 3 72
N 4 24
N 5 10
N 6 1
#0~4差分机初始化
#5~6循环变量

-
L 5
L 6
?F 16
S 5
P 0
+
L 0
L 1
S 0
L 1
L 2
S 1
L 2
L 3
S 2
L 3
L 4
S 3
B 20
```
#### T4
```
N 0 99991
N 1 1
N 2 1
N 3 2
#v0 当前剩余 v1 当前枚举 v2 常数1 v3 常数2 

+
L 1
L 2
S 1
*
L 1
L 1
S 9
-
L 0
L 9
?F 1
F 6
-
L 0
L 3
?F 24
#退出
P 0
F 22
#退出
/
L 0
L 1
S' 9
*
L 9
L 1
S 9
-
L 9
L 0
?B 31
#除不尽，下一次
P 1
/
L 0
L 1
S' 0
-
L 1
L 2
S 1
B 41
# 返回
```
## 笔记
### 分析机的体系结构
- 包含的要素：存储器、控制系统、运算器、输入输出等
- 它基本对应了哈佛架构：有处理器、寄存器(mill)、存储器(Store)、输入输出设备(输出是都有，在最小指令集中，输入是作为初始值存在Store里的)
## Q&A
- 怎么判断两个数大小？直接相减，用runup搭配条件跳转来实现
## 附录
- [一个与我们课程ppt里的分析机语法兼容的本地版解释器](https://github.com/Conless/x86-linux-analytical-engine-simulator)